<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">
        <%= image_tag 'logo2.jpg', id: 'Logo' %> Dance School
      </a>
    </div>
    
    <% nav_links = [] %>
    <% if current_user %>
      <% if current_user.role == 'student' %>
        <% nav_links = [
          { name: 'Home', path: '/student' },
          { name: 'Grafik', path: '/cours' },
          { name: 'Moje ZajÄ™cia', path: '/my_course' },
          { name: 'Profil', path: '/student_profile' },
          { name: 'Wyloguj', path: '/student_sign_out' }
        ] %>
      <% elsif current_user.role == 'teacher' %>
        <% nav_links = [
          { name: 'Home', path: '/teacher' },
          { name: 'Grafik', path: '/cours' },
          { name: 'Prowadzone ZajÄ™cia', path: '/own_course' },
          { name: 'Profil', path: '/teacher_profile' },
          { name: 'Wyloguj', path: '/teacher_sign_out' }
        ] %>
      <% end %>
    <% else %>
      <% nav_links = [
        { name: 'Home', path: '/main_stage' },
        { name: 'Logowanie', path: '/login' },
        { name: 'Kursy', path: '/cours', active: true },
        { name: 'Pomoc', path: '/help' },
        { name: 'Kontakt', path: '/contact' }
      ] %>
    <% end %>

    <ul class="nav nav-pills navbar-left">
      <% nav_links.each do |link| %>
        <li class="<%= 'active' if link[:active] %>">
          <a href="<%= link[:path] %>"><%= link[:name] %></a>
        </li>
      <% end %>
    </ul>

    <form class="navbar-form navbar-right" style="display: flex; align-items: center;">
      <div class="form-group">
        <input type="text" class="form-control" placeholder="Szukaj na stronie...">
      </div>
      <button type="submit" class="btn btn-default" id="searchButton"><b> ðŸ”Ž </b></button>
    </form>

    <div class="navbar-right" style="display: flex; align-items: center; margin-left: 10px;">
      <% if current_user %>
        <button type="button" class="btn btn-primary navbar-btn">
          <%= link_to "Profil", current_user.role == 'student' ? "/student_profile" : "/teacher_profile", style: "color:white; text-decoration: none;" %>
        </button>
        <%= button_to "Wyloguj siÄ™", destroy_user_session_path, method: :delete, class: "btn btn-primary navbar-btn", style: "color:white; text-decoration: none;" %>
      <% else %>
        <button type="button" class="btn btn-primary navbar-btn">
          <%= link_to "Zarejestruj siÄ™", new_user_registration_path, style: "color:white; text-decoration: none;" %>
        </button>
        <button type="button" class="btn btn-primary navbar-btn">
          <%= link_to "Zaloguj siÄ™", new_user_session_path, style: "color:white; text-decoration: none;" %>
        </button>
      <% end %>
    </div>
  </div>
</nav>

<p style="color: green"><%= notice %></p>
<h1>Kurs</h1>
<%= render @course %>
<% if current_user && current_user.role == 'teacher' %>
<center><div class="actions" style="margin-top: 30px; margin-bottom: 20px;">
  <%= link_to "Edit this course", edit_course_path(@course) , class: "btn btn-primary btn-lg",style:"color:white; text-decoration: none;" %> 
  <% end %>
  <center><div class="actions" style="margin-top: 30px; margin-bottom: 20px;">
  <%= link_to "Back to courses" , courses_path , class: "btn btn-primary btn-lg",style:"color:white; text-decoration: none;" %>

  <% if current_user && !@course.users.include?(current_user) %>
  <%= form_with url: course_course_registrations_path(@course), method: :post do %>
    <center><div class="actions" style="margin-top: 30px; margin-bottom: 20px;">
    <%= submit_tag "Enroll in this course" , class: "btn btn-primary btn-lg",style:"color:white; text-decoration: none;" %>
  <% end %>
<% if current_user && current_user.role == 'teacher' %>
<h2>Zapisani kursanci na kurs</h2>
<ul>
  <% @course.users.each do |user| %>
    <li><%= user.first_name %> <%= user.last_name %> - <%= user.email %></li>
  <% end %>
</ul>
<% end %>


<h2>PoszczegÃ³lne lekcje dla <%= @course.name %></h2>

<ul>
  <% @course.lessons.each do |lesson| %>
    <li>
      <%= link_to lesson.name, lesson_path(lesson) %> - <%= lesson.date.strftime("%B %d, %Y at %I:%M %p") %>
      <% if current_user && !lesson.users.include?(current_user) %>
        <%= form_with url: enroll_lesson_path(lesson), method: :post do %>
          <center><div class="actions" style="margin-top: 30px; margin-bottom: 20px;">
          <%= submit_tag "Enroll in this lesson", class: "btn btn-primary btn-lg",style:"color:white; text-decoration: none;" %>
  <% end %>
      <% else %>
        (Already enrolled)
      <% end %>
    </li>
  <% end %>
</ul>

<div>

<% elsif current_user && @course.users.include?(current_user) %>
  <p>You are already enrolled in this course.</p>
<% else %>
  <p>Please log in to enroll in the course.</p>
<% end %>
<% if current_user && current_user.role == 'teacher' %>
<center><div class="actions" style="margin-top: 30px; margin-bottom: 20px;">
  <%= button_to "Destroy this course" , @course, method: :delete  , class: "btn btn-primary btn-lg",style:"color:white; text-decoration: none;"%>
  <% end %>
  </div>
